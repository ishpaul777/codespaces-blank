FROM golang:1.19.7-alpine3.16

WORKDIR /app

COPY . .

RUN apk add gcc musl-dev
RUN go mod download

RUN go install github.com/githubnemo/CompileDaemon@latest

ENTRYPOINT CompileDaemon -exclude-dir=.git -exclude-dir=docs --build="go build cmd/main.go" --command="./main serve"